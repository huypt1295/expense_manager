## Expense Manager

### Overview
A modular Flutter application for managing expenses. The project separates core logic, shared resources, and feature modules. It leverages dependency injection (DI), modern navigation, Bloc for state management, and an OCR-based receipt scanning feature to extract expense data.

### Screenshots
- `screenshot/Screenshot_20251027_230145.png`: Trang tong quan hien thi thu nhap, chi tieu va bieu do chi trong 7 ngay gan nhat.
- `screenshot/Screenshot_20251027_230155.png`: Danh sach giao dich theo ngay voi tong chi va chi tiet tung khoan.
- `screenshot/Screenshot_20251027_230202.png`: Trang ngan sach tong quan voi han muc, so tien da chi va bieu do phan bo theo danh muc.
- `screenshot/Screenshot_20251027_230216.png`: Man hinh ho so & cai dat voi lua chon ngon ngu, chu de va lien ket ho tro.
- `screenshot/Screenshot_20251027_230223.png`: Bottom sheet them giao dich gom Smart Expense Scanner va cac truong nhap tay.
- `screenshot/Screenshot_20251027_230232.png`: Bieu mau tao ngan sach theo danh muc voi tuy chon thoi gian va so tien.

### Tech Stack
- **Flutter/Dart**: Dart >= 3.2.3, recommended Flutter >= 3.16.x
- **State management**: `bloc`, `flutter_bloc`
- **Navigation**: `go_router`
- **Dependency Injection**: `get_it` + `injectable`
- **UI/UX**: `flutter_easyloading`, `lottie`
- **OCR / Imaging**: `google_ml_kit`, `image_picker`, `image`
- **Others**: `http`, `json_serializable`, `freezed`

### Project Structure (high level)
- `lib/`
    - `main.dart`: App bootstrap, DI initialization, and loading configuration (`EasyLoading` + `Lottie`).
    - `app/app.dart`: Declares `MaterialApp.router`, theme, locale, router.
    - `core/`
        - `config/`: `AppConfig`, `ConfigCubit` (default theme and locale `vi`).
        - `routing/`: `AppRouter` (initial route `/` → `HomePage`).
        - `di/`: `injector.dart`, `injector.config.dart` (generated by `injectable`).
    - `features/`
        - `home/`: `HomePage`, `HomeBloc`.
        - `budget/`: `budget_page.dart`.
        - `transactions/`: `transaction_page.dart` plus `presentation/add_transaction/` for the add-expense flow (widgets, helpers, OCR service README).
        - `profile_setting/`: Domain (entities/repositories/usecases) + data + presentation.
- `shared_packages/`
    - `flutter_core/`: Core foundations (base classes, navigation, network, exception handling, base bloc, DI module).
    - `flutter_common/`: Shared utilities and components, DI module.
    - `flutter_resource/`: Themes, colors, fonts, images, l10n (ARB + generated code), DI module.

### Setup & Run
1. **Requirements**
    - Install Flutter SDK (recommended 3.16.x) and Dart >= 3.2.3
    - Set up iOS/Android toolchains per Flutter documentation
2. **Install dependencies**
   ```bash
   flutter pub get
   ```
3. **Code generation (when you change DI/models/freezed/l10n)**
    - In the app root:
      ```bash
      dart run build_runner build --delete-conflicting-outputs
      ```
    - In each package when changed (run inside the package directory):
      ```bash
      # shared_packages/flutter_core
      dart run build_runner build --delete-conflicting-outputs
 
      # shared_packages/flutter_common
      dart run build_runner build --delete-conflicting-outputs
 
      # shared_packages/flutter_resource (when l10n changes)
      dart run build_runner build --delete-conflicting-outputs
      flutter pub run intl_utils:generate
      ```
4. **Run the app**
   ```bash
   flutter run
   # or target a specific device
   flutter run -d ios
   flutter run -d android
   ```

### Navigation, DI, Theme/Locale
- **Router**: `AppRouter` uses `go_router`; initial route `/` → `HomePage`.
- **DI**: `configureDependencies()` loads modules from `flutter_core`, `flutter_common`, `flutter_resource` and registers `AppRouter`, repositories, use cases, blocs.
- **Theme/Locale**: Driven by `AppConfig` via `ConfigCubit`; defaults to `ThemeType.light` and locale `vi`.

### OCR (receipt scanning)
- Source: `lib/features/transactions/presentation/add_transaction/services/expense_ai_service.dart`
- Uses `google_ml_kit` for text recognition, with image pre-processing and fallback methods.
- See the detailed guide: `lib/features/transactions/presentation/add_transaction/services/README.md`.

### Shared Packages (detailed)
- **flutter_core**
    - **Purpose**: Application foundations and infrastructural building blocks used across modules.
    - **Highlights**:
        - DI scaffolding: `get_it`, `injectable` modules (e.g., `src/di/injector.dart`, `injector.module.dart`).
        - Navigation base: `src/navigation/base_router.dart`; integrates `go_router`.
        - Presentation base: Base Bloc/Cubit and state/event primitives in `src/presentation/bloc/`.
        - Network layer: `src/network/` with `dio`, API constants, and future middleware hooks.
        - Error/Exception: Rich exception hierarchy and mappers in `src/exception/` (including Dio mappers).
        - Localization service: `src/localization/locale_service.dart` for locale interactions.
        - Utilities: `src/utils/` including `run_catching` (Result type), disposables/DisposeBag, typedefs, etc.
    - **Key dependencies**: `injectable`, `get_it`, `go_router`, `bloc`, `flutter_bloc`, `dio`, `freezed_annotation`, `flutter_easyloading`, `lottie`.
    - **Used by**: The app root for DI and navigation; feature modules rely on base blocs, exceptions, and utils.

- **flutter_common**
    - **Purpose**: Cross-cutting reusable components and utilities shared by features.
    - **Highlights**:
        - Components: `lib/src/components/` (placeholders for shared UI pieces).
        - Utilities: `lib/src/utils/` (collections, colors, context extensions, date/time, files, intents, logging, numbers, regex, strings, validation, view helpers).
        - DI module: `src/di/injector.dart`, `injector.module.dart` to expose common services/utilities.
    - **Key dependencies**: Depends on `flutter_core` and `flutter_resource`; uses `freezed_annotation` for modeling where needed.
    - **Used by**: Features for convenience helpers and shared widgets; also contributes external DI modules consumed by the app.

- **flutter_resource**
    - **Purpose**: Centralized app look & feel, assets, and localization resources.
    - **Highlights**:
        - Assets: `assets/images/`, `assets/fonts/`, `assets/lottie/`, and JSON mocks.
        - Theming: `lib/src/theme/` with color tokens, typography, and theme builders (`ThemeType`).
        - Resources index: `lib/src/resources/` for typed asset access.
        - Localization (l10n): ARB files under `lib/l10n/` and generated code under `lib/l10n/gen/` (messages for `en` and `vi`).
        - DI module: `src/di/injector.dart`, `injector.module.dart` to provide theme/localization related services.
    - **Key dependencies**: `flutter_localizations`, `intl`, `flutter_svg`; build-time `intl_utils` for code generation.
    - **Used by**: App theme/locale configuration and asset access across all features.

### Development Notes
- When adding/updating annotations for `injectable`, `json_serializable`, or `freezed`, run build_runner again.
- Assets (fonts/images/lottie) are provided via `flutter_resource`. Ensure correct asset paths (e.g., `assets/lottie/newLoading.json`).

### License
Internal/learning use only. Update this section if you plan to publish publicly.
